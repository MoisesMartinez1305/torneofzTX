{% extends "base_admin.html" %}

{% block admin_content %}
<div class="container mt-3 mt-md-4">
    <div class="card border-0 shadow-lg">
        <!-- Encabezado de la tarjeta -->
        <div class="card-header bg-primary text-white py-3">
            <h4 class="mb-0 fs-4 fs-md-3">
                <i class="fas fa-plus-circle me-2"></i>Crear Nuevo Torneo
            </h4>
        </div>
        
        <!-- Cuerpo del formulario -->
        <div class="card-body p-3 p-md-4">
            <form method="POST" action="{{ url_for('crear_torneo') }}">
                <!-- Campo: Número de ligas -->
                <div class="mb-4">
                    <label for="num_ligas" class="form-label fw-medium">Número de Ligas</label>
                    <select class="form-select form-select-lg" id="num_ligas" name="num_ligas" required onchange="generarCamposLigas()">
                        {% for i in range(1, 7) %}
                            <option value="{{ i }}">{{ i }} liga{% if i > 1 %}s{% endif %}</option>
                        {% endfor %}
                    </select>
                    <small class="text-muted">Máximo 6 ligas por torneo</small>
                </div>

                <!-- Contenedor dinámico para ligas -->
                <div id="ligas-container">
                    <!-- Los campos se generarán aquí con JS -->
                </div>
                
                <!-- Botones de acción -->
                <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-outline-secondary btn-lg flex-grow-1 flex-md-grow-0">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </a>
                    <button type="submit" class="btn btn-primary btn-lg flex-grow-1 flex-md-grow-0">
                        <i class="fas fa-save me-2"></i>Crear Torneo
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
    .liga-section {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        border: 1px solid #dee2e6;
    }
    
    .liga-header {
        background-color: #e9ecef;
        padding: 0.75rem 1rem;
        border-radius: 6px;
        margin-bottom: 1rem;
        font-weight: 600;
    }
    
    @media (max-width: 768px) {
        .card-header h4 {
            font-size: 1.25rem !important;
        }
        
        .form-select-lg, .form-control-lg {
            padding: 0.5rem 1rem;
            font-size: 1rem;
        }
        
        .btn-lg {
            padding: 0.5rem 1rem;
            font-size: 1rem;
        }
        
        .liga-section {
            padding: 1rem;
        }
    }
    
    @media (max-width: 576px) {
        .card-body {
            padding: 1rem !important;
        }
        
        .equipos-container .mb-3 {
            margin-bottom: 0.5rem !important;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Generar campos iniciales
        generarCamposLigas();
    });

    function generarCamposLigas() {
        const numLigas = document.getElementById('num_ligas').value;
        const container = document.getElementById('ligas-container');
        container.innerHTML = '';
        
        // Validación rápida
        if (numLigas < 1 || numLigas > 6) return;
        
        // Generar secciones para cada liga
        for (let i = 1; i <= numLigas; i++) {
            const ligaDiv = document.createElement('div');
            ligaDiv.className = 'liga-section';
            ligaDiv.id = `liga-${i}-section`;
            
            // Encabezado de la liga
            const headerDiv = document.createElement('div');
            headerDiv.className = 'liga-header d-flex justify-content-between align-items-center';
            headerDiv.innerHTML = `
                <span>Liga ${i}</span>
                <small class="text-muted">Obligatorio</small>
            `;
            
            // Nombre de la liga
            const nombreDiv = document.createElement('div');
            nombreDiv.className = 'mb-3';
            nombreDiv.innerHTML = `
                <label for="nombre_liga_${i}" class="form-label">Nombre de la Liga</label>
                <input type="text" class="form-control" id="nombre_liga_${i}" 
                       name="nombre_liga_${i}" value="Liga ${i}" required>
            `;
            
            // Número de equipos
            const equiposDiv = document.createElement('div');
            equiposDiv.className = 'mb-3';
            equiposDiv.innerHTML = `
                <label for="num_equipos_${i}" class="form-label">Número de Equipos</label>
                <input type="number" class="form-control" id="num_equipos_${i}" 
                       name="num_equipos_${i}" min="2" max="20" required
                       onchange="generarCamposEquipos(${i})">
                <small class="text-muted">Mínimo 2, máximo 20 equipos</small>
            `;
            
            // Contenedor para nombres de equipos
            const equiposContainer = document.createElement('div');
            equiposContainer.className = 'row g-2 equipos-container';
            equiposContainer.id = `equipos-container-${i}`;
            
            // Ensamblar la sección
            ligaDiv.appendChild(headerDiv);
            ligaDiv.appendChild(nombreDiv);
            ligaDiv.appendChild(equiposDiv);
            ligaDiv.appendChild(equiposContainer);
            
            container.appendChild(ligaDiv);
        }
    }

    function generarCamposEquipos(ligaNum) {
        const numEquipos = document.getElementById(`num_equipos_${ligaNum}`).value;
        const container = document.getElementById(`equipos-container-${ligaNum}`);
        container.innerHTML = '';
        
        // Validación rápida
        if (numEquipos < 2 || numEquipos > 20) return;
        
        // Generar campos responsivos
        for (let i = 1; i <= numEquipos; i++) {
            const col = document.createElement('div');
            col.className = 'col-12 col-md-6 col-lg-4'; // 1 columna en móvil, 2 en tablet, 3 en PC
            
            const div = document.createElement('div');
            div.className = 'mb-3';
            
            const label = document.createElement('label');
            label.className = 'form-label';
            label.textContent = `Equipo ${i}`;
            label.htmlFor = `equipo_${ligaNum}_${i}`;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'form-control';
            input.id = `equipo_${ligaNum}_${i}`;
            input.name = `equipo_${ligaNum}_${i}`;
            input.required = true;
            input.placeholder = `Nombre del equipo ${i}`;
            
            div.appendChild(label);
            div.appendChild(input);
            col.appendChild(div);
            container.appendChild(col);
        }
    }
</script>
{% endblock %}